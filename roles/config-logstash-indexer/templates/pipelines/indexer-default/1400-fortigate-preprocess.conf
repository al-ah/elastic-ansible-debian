filter {
	
	if [event][dataset] == "fortinet.firewall" {
		kv{
			id => "kv_forti_1223"
			source => "message"
			target  => "forti"
			trim_value  => '"'
			field_split_pattern  => "\s(?=\w+=)"
			value_split => "="
			include_keys => [ "action","agent","app","appcat","applist","catdesc","ccertissuer","collectedemail","comment","daddr","devid","dir","direction","dst_host","dstcollectedemail","dst_int","dstintf","dstip","dstmac","dstname","dst_port","dstport","dstunauthuser","dtype","duration","errorcode","event_id","eventid","eventtime","eventtype","file","filename","filesize","filetype","filehash","from","group","hostname","infectedfilename","infectedfilesize","infectedfiletype","ipaddr","level","locip","locport","logdesc","logid","matchfilename","matchfiletype","msg","error_num","policyid","policy_id","policyname","policytype","poluuid","profile","proto","qclass","qname","qtype","rcvdbyte","rcvdpkt","recipient","ref","remip","remport","saddr","scertcname","scertissuer","sender","sentbyte","sentpkt","service","sess_duration","srcdomain","srcintf","srcip","source_mac","srcmac","srcport","tranip","tranport","transip","transport","tz","unauthuser","url","user","xid"]
			
		}
		
		mutate {
			id => "raname_kv_forti_1223"
			rename => {
				"[forti][action]" => "[event][action]"
				"[forti][agent]" => "[user_agent][original]"
				"[forti][app]" => "[network][application]"
				"[forti][appcat]" => "[rule][category]"
				"[forti][applist]" => "[rule][ruleset]"
				"[forti][catdesc]" => "[rule][category]"
				"[forti][ccertissuer]" => "[tls][client_issuer]"
				"[forti][collectedemail]" => "[source][user][email]"
				"[forti][comment]" => "[rule][description]"
				"[forti][daddr]" => "[destination][address]"
				"[forti][devid]" => "[observer][serial_number]"
				"[forti][dir]" => "[network][direction]"
				"[forti][direction]" => "[network][direction]"
				"[forti][dst_host]" => "[destination][address]"
				"[forti][dstcollectedemail]" => "[destination][user][email]"
				"[forti][dst_int]" => "[observer][egress][interface][name]"
				"[forti][dstintf]" => "[observer][egress][interface][name]"
				"[forti][dstip]" => "[destination][ip]"
				"[forti][dstmac]" => "[destination][mac]"
				"[forti][dstname]" => "[destination][address]"
				"[forti][dst_port]" => "[destination][port]"
				"[forti][dstport]" => "[destination][port]"
				"[forti][dstunauthuser]" => "[destination][user][name]"
				"[forti][dtype]" => "[vulnerability][category]"
				"[forti][duration]" => "[event][duration]"
				"[forti][errorcode]" => "[error][code]"
				"[forti][event_id]" => "[event][id]"
				"[forti][eventid]" => "[event][id]"
				"[forti][eventtime]" => "[event][start]"
				"[forti][eventtype]" => "[event][action]"
				"[forti][file]" => "[file][name]"
				"[forti][filename]" => "[file][name]"
				"[forti][filesize]" => "[file][size]"
				"[forti][filetype]" => "[file][extension]"
				"[forti][filehash]" => "[file][hash][crc32]"
				"[forti][from]" => "[source][user][email]"
				"[forti][group]" => "[source][user][group]"
				"[forti][hostname]" => "[url][domain]"
				"[forti][infectedfilename]" => "[file][name]"
				"[forti][infectedfilesize]" => "[file][size]"
				"[forti][infectedfiletype]" => "[file][extension]"
				"[forti][ipaddr]" => "[dns][resolved_ip]"
				"[forti][level]" => "[log][level]"
				"[forti][locip]" => "[source][ip]"
				"[forti][locport]" => "[source][port]"
				"[forti][logdesc]" => "[rule][description]"
				"[forti][logid]" => "[event][code]"
				"[forti][matchfilename]" => "[file][name]"
				"[forti][matchfiletype]" => "[file][extension]"
				"[forti][msg]" => "[message]"
				"[forti][error_num]" => "[error][code]"
				"[forti][policyid]" => "[rule][id]"
				"[forti][policy_id]" => "[rule][id]"
				"[forti][policyname]" => "[rule][name]"
				"[forti][policytype]" => "[rule][ruleset]"
				"[forti][poluuid]" => "[rule][uuid]"
				"[forti][profile]" => "[rule][ruleset]"
				"[forti][proto]" => "[network][iana_number]"
				"[forti][qclass]" => "[dns][question][class]"
				"[forti][qname]" => "[dns][question][name]"
				"[forti][qtype]" => "[dns][question][type]"
				"[forti][rcvdbyte]" => "[source][bytes]"
				"[forti][rcvdpkt]" => "[source][packets]"
				"[forti][recipient]" => "[destination][user][email]"
				"[forti][ref]" => "[event][reference]"
				"[forti][remip]" => "[destination][ip]"
				"[forti][remport]" => "[destination][port]"
				"[forti][saddr]" => "[source][address]"
				"[forti][scertcname]" => "[tls][client][server_name]"
				"[forti][scertissuer]" => "[tls][server][issuer]"
				"[forti][sender]" => "[source][user][email]"
				"[forti][sentbyte]" => "[source][bytes]"
				"[forti][sentpkt]" => "[source][packets]"
				"[forti][service]" => "[network][protocol]"
				"[forti][sess_duration]" => "[event][duration]"
				"[forti][srcdomain]" => "[source][domain]"
				"[forti][srcintf]" => "[observer][ingress][interface][name]"
				"[forti][srcip]" => "[source][ip]"
				"[forti][source_mac]" => "[source][mac]"
				"[forti][srcmac]" => "[source][mac]"
				"[forti][srcport]" => "[source][port]"
				"[forti][tranip]" => "[destination][nat][ip]"
				"[forti][tranport]" => "[destination][nat][port]"
				"[forti][transip]" => "[source][nat][ip]"
				"[forti][transport]" => "[source][nat][port]"
				"[forti][tz]" => "[event][timezone]"
				"[forti][unauthuser]" => "[source][user][name]"
				"[forti][url]" => "[url][path]"
				"[forti][user]" => "[source][user][name]"
				"[forti][xid]" => "[dns][id]"
			}
		}
	}
}