
auditbeat.modules:

- module: auditd
  # Load audit rules from separate files. Same format as audit.rules(7).
  audit_rule_files: [ '${path.config}/audit.rules.d/*.conf' ]
  audit_rules: |
    ## Define audit rules here.
    ## Create file watches (-w) or syscall audits (-a or -A). Uncomment these
    ## examples or add your own rules.

- module: file_integrity
  paths:
  - /bin
  - /usr/bin
  - /sbin
  - /usr/sbin
  - /etc

- module: system
  datasets:
    - package # Installed, updated, and removed packages

  period: 2m # The frequency at which the datasets check for changes

- module: system
  datasets:
    - host    # General host information, e.g. uptime, IPs
    - login   # User logins, logouts, and system boots.
    - process # Started and stopped processes
    - socket  # Opened and closed sockets
    - user    # User information

  # How often datasets send state updates with the
  # current state of the system (e.g. all currently
  # running processes, all open sockets).
  state.period: 12h

  # Enabled by default. Auditbeat will read password fields in
  # /etc/passwd and /etc/shadow and store a hash locally to
  # detect any changes.
  user.detect_password_changes: true

  # File patterns of the login record files.
  login.wtmp_file_pattern: /var/log/wtmp*
  login.btmp_file_pattern: /var/log/btmp*

# ================================= Processors =================================

# Configure processors to enhance or manipulate events generated by the beat.

processors:
  - add_host_metadata: ~
#  - add_cloud_metadata: ~
#  - add_docker_metadata: ~

# ------------------------------ Logstash Output -------------------------------
output.logstash:
  # The Logstash hosts
  hosts: ["collector.{{ domain_name }}:5044"]
  # Optional SSL. By default is off.
  # List of root certificates for HTTPS server verifications
  #ssl.certificate_authorities: ["/etc/pki/root/ca.pem"]

  # Certificate for SSL client authentication
  #ssl.certificate: "/etc/pki/client/cert.pem"

  # Client Certificate Key
  #ssl.key: "/etc/pki/client/cert.key"
  
### ---------------------------- ### for setup auditbeat #### ------------------
#setup.kibana:
#  host: "https://NODE_NAME.DOMAIN_NAME:5601"
#  #ssl.enabled: true
#  ssl.certificate_authorities: ["/etc/auditbeat/certs/ca.crt"]
#  ssl.verification_mode: "certificate"
#  username: "elastic"  
#  password: "ELASTIC_USER_PASS"
#  
#setup.template.settings:
#  index.number_of_shards: 1
#  #index.codec: best_compression
#  #_source.enabled: false
#output.elasticsearch:
#  # Array of hosts to connect to.
#  hosts: ["https://NODE_NAME.DOMAIN_NAME:9200"]
#  ssl.certificate_authorities: ["/etc/auditbeat/certs/ca.crt"]
#  username: "elastic"  
#  password: "ELASTIC_USER_PASS"
### ---------------------------- ### for setup auditbeat #### --------------------
